<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>SQL w MS Access â€“ Zadania 7.1â€“7.5</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Reveal.js CSS -->
  <link rel="stylesheet" href="https://unpkg.com/reveal.js/dist/reveal.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js/dist/theme/black.css" id="theme">

  <style>
    h1, h2, h3 { color: #FFD700; }
    p, li { color: #FFFFFF; font-size: 1.1em; }
    code { background: #222; color: #00FF7F; padding: 4px; border-radius: 4px; }
    .highlight { color: #00BFFF; font-weight: bold; }
    .important { color: #FF4500; font-weight: bold; }
    img { border: 2px solid #00BFFF; border-radius: 10px; }
  </style>
</head>
<body>

<div class="reveal">
<div class="slides">

<!-- Intro -->
<section>
  <h1>ğŸš€ SQL w MS Access</h1>
  <h3>Realizacja zadaÅ„ 7.1â€“7.5 krok po kroku</h3>
  <p>Przewodnik dla osÃ³b, ktÃ³re <span class="highlight">nigdy wczeÅ›niej</span> nie pracowaÅ‚y z Access SQL.</p>
</section>

<!-- Przygotowanie -->
<section>
  <h2>ğŸ“š Zanim zaczniemy...</h2>
  <ul>
    <li>Zrozum, czym jest <span class="highlight">baza danych</span>.</li>
    <li>Poznaj pojÄ™cia: <span class="highlight">tabela</span>, <span class="highlight">rekord</span>, <span class="highlight">kolumna</span>.</li>
    <li>Dowiedz siÄ™, czym jest <span class="highlight">SQL</span> â€“ jÄ™zyk zapytaÅ„ do baz danych.</li>
  </ul>
</section>

<section>
  <h2>ğŸ”§ MateriaÅ‚y do nauki</h2>
  <ul>
    <li>Podstawy SQL â€“ <a href="https://www.w3schools.com/sql/" target="_blank">W3Schools SQL Tutorial</a></li>
    <li>Podstawy Access â€“ <a href="https://support.microsoft.com/pl-pl/access" target="_blank">Microsoft Access Support</a></li>
    <li>Ä†wiczenia z JOIN, GROUP BY, WHERE</li>
  </ul>
</section>

<!-- Screenshoty przygotowania -->
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 1</h2><img src="przygotowanie/1.png" alt="Przygotowanie Accessa krok 1" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 2</h2><img src="przygotowanie/2.png" alt="Przygotowanie Accessa krok 2" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 3</h2><img src="przygotowanie/3.png" alt="Przygotowanie Accessa krok 3" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 4</h2><img src="przygotowanie/4.png" alt="Przygotowanie Accessa krok 4" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 5</h2><img src="przygotowanie/5.png" alt="Przygotowanie Accessa krok 5" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 6</h2><img src="przygotowanie/6.png" alt="Przygotowanie Accessa krok 6" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 7</h2><img src="przygotowanie/7.png" alt="Przygotowanie Accessa krok 7" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 8</h2><img src="przygotowanie/8.png" alt="Przygotowanie Accessa krok 8" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 9</h2><img src="przygotowanie/9.png" alt="Przygotowanie Accessa krok 9" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 10</h2><img src="przygotowanie/10.png" alt="Przygotowanie Accessa krok 10" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 11</h2><img src="przygotowanie/11.png" alt="Przygotowanie Accessa krok 11" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 12</h2><img src="przygotowanie/12.png" alt="Przygotowanie Accessa krok 12" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 13</h2><img src="przygotowanie/13.png" alt="Przygotowanie Accessa krok 13" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 14</h2><img src="przygotowanie/14.png" alt="Przygotowanie Accessa krok 14" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 15</h2><img src="przygotowanie/15.png" alt="Przygotowanie Accessa krok 15" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 16</h2><img src="przygotowanie/16.png" alt="Przygotowanie Accessa krok 16" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 17</h2><img src="przygotowanie/17.png" alt="Przygotowanie Accessa krok 17" style="width:80%;"></section>
<section><h2>ğŸ“· Przygotowanie Accessa â€“ krok 18</h2><img src="przygotowanie/18.png" alt="Przygotowanie Accessa krok 18" style="width:80%;"></section>

<section>
  <h2>ğŸ—‚ Struktura naszej bazy</h2>
  <ul>
    <li><span class="highlight">Laziki</span> â€“ dane o Å‚azikach</li>
    <li><span class="highlight">Obszary</span> â€“ nazwy i kody obszarÃ³w</li>
    <li><span class="highlight">Pomiary</span> â€“ dane pomiarowe</li>
    <li><span class="highlight">Producent</span> â€“ producenci Å‚azikÃ³w</li>
  </ul>
</section>

<!-- Zadanie 7.1 -->
<section>
  <h2>ğŸ’§ Zadanie 7.1 â€“ Cel</h2>
  <p>ZnajdÅº obszar z <span class="important">najwiÄ™kszÄ… iloÅ›ciÄ… wody</span> (mÂ³) na gÅ‚Ä™bokoÅ›ci â‰¤ 100 m.</p>
</section>

<section>
  <h2>Kod SQL</h2>
  <pre><code class="sql">
SELECT TOP 1 o.nazwa_obszaru,
       SUM(p.ilosc) AS suma_wody_m3
FROM obszary AS o
INNER JOIN pomiary AS p
    ON p.kod_obszaru = o.kod_obszaru
WHERE p.glebokosc <= 100
GROUP BY o.nazwa_obszaru
ORDER BY SUM(p.ilosc) DESC;
  </code></pre>
</section>

<section>
  <h2>OgÃ³lne omÃ³wienie</h2>
  <ul>
    <li>ÅÄ…czymy obszary z pomiarami.</li>
    <li>Filtrujemy tylko pomiary do 100 m gÅ‚Ä™bokoÅ›ci.</li>
    <li>Sumujemy iloÅ›Ä‡ wody dla kaÅ¼dego obszaru.</li>
    <li>Wybieramy obszar z najwiÄ™kszÄ… sumÄ….</li>
  </ul>
</section>

<section>
  <h2>Analiza linia po linii</h2>
  <ul>
    <li><code>SELECT TOP 1</code> â€“ wybierz tylko pierwszy rekord po sortowaniu.</li>
    <li><code>SUM(p.ilosc)</code> â€“ sumuje iloÅ›Ä‡ wody.</li>
    <li><code>INNER JOIN</code> â€“ Å‚Ä…czy dane z dwÃ³ch tabel po wspÃ³lnym polu.</li>
    <li><code>WHERE p.glebokosc <= 100</code> â€“ filtruje dane.</li>
    <li><code>GROUP BY</code> â€“ grupuje wyniki wedÅ‚ug obszaru.</li>
    <li><code>ORDER BY ... DESC</code> â€“ sortuje malejÄ…co.</li>
  </ul>
</section>

<!-- Zadanie 7.2 -->
<section>
  <h2>â³ Zadanie 7.2 â€“ Cel</h2>
  <p>ZnajdÅº Å‚azik z <span class="important">najdÅ‚uÅ¼szym okresem pomiarÃ³w</span> i podaj daty pierwszego i ostatniego pomiaru.</p>
</section>

<section>
  <h2>Kod SQL</h2>
  <pre><code class="sql">
SELECT TOP 1 l.nazwa_lazika,
       MIN(p.data_pomiaru) AS pierwszy_pomiar,
       MAX(p.data_pomiaru) AS ostatni_pomiar,
       DATEDIFF('d', MIN(p.data_pomiaru), MAX(p.data_pomiaru)) AS liczba_dni
FROM laziki AS l
INNER JOIN pomiary AS p
    ON l.nr_lazika = p.nr_lazika
GROUP BY l.nazwa_lazika
ORDER BY DATEDIFF('d', MIN(p.data_pomiaru), MAX(p.data_pomiaru)) DESC;
  </code></pre>
</section>

<section>
  <h2>OgÃ³lne omÃ³wienie</h2>
  <ul>
    <li>ÅÄ…czymy Å‚aziki z ich pomiarami.</li>
    <li>Znajdujemy najwczeÅ›niejszy i najpÃ³Åºniejszy pomiar.</li>
    <li>Obliczamy rÃ³Å¼nicÄ™ w dniach.</li>
    <li>Wybieramy Å‚azik z najwiÄ™kszÄ… rÃ³Å¼nicÄ….</li>
  </ul>
</section>

<section>
  <h2>Analiza linia po linii</h2>
  <ul>
    <li><code>MIN()</code> â€“ najwczeÅ›niejsza data pomiaru.</li>
    <li><code>MAX()</code> â€“ najpÃ³Åºniejsza data pomiaru.</li>
    <li><code>DATEDIFF('d', ...)</code> â€“ liczba dni miÄ™dzy datami.</li>
    <li><code>GROUP BY</code> â€“ grupuje dane wedÅ‚ug Å‚azika.</li>
    <li><code>ORDER BY ... DESC</code> â€“ sortuje od najwiÄ™kszej rÃ³Å¼nicy.</li>
  </ul>
</section>

<!-- Zadanie 7.3 -->
<section>
  <h2>ğŸ›° Zadanie 7.3 â€“ Cel</h2>
  <p>ZnajdÅº obszary, gdzie <span class="important">nie byÅ‚o pomiaru</span> w roku wysÅ‚ania Å‚azika.</p>
</section>

<section>
  <h2>Kod SQL</h2>
  <pre><code class="sql">
SELECT o.nazwa_obszaru
FROM obszary AS o
WHERE o.kod_obszaru NOT IN (
    SELECT DISTINCT p.kod_obszaru
    FROM pomiary AS p
    INNER JOIN laziki AS l
        ON p.nr_lazika = l.nr_lazika
    WHERE YEAR(p.data_pomiaru) = l.rok_wyslania
)
ORDER BY o.nazwa_obszaru;
  </code></pre>
</section>

<section>
  <h2>OgÃ³lne omÃ³wienie</h2>
  <ul>
    <li>Podzapytanie wybiera obszary, w ktÃ³rych byÅ‚ pomiar w roku wysÅ‚ania Å‚azika.</li>
    <li><span class="highlight">NOT IN</span> â€“ odrzuca te obszary, ktÃ³re speÅ‚niajÄ… warunek w podzapytaniu.</li>
    <li>W efekcie zostajÄ… tylko obszary bez takich pomiarÃ³w.</li>
  </ul>
</section>

<section>
  <h2>Analiza linia po linii</h2>
  <ul>
    <li><code>SELECT o.nazwa_obszaru</code> â€“ wybieramy nazwy obszarÃ³w.</li>
    <li><code>WHERE o.kod_obszaru NOT IN (...)</code> â€“ filtrujemy, aby wykluczyÄ‡ obszary z listy w podzapytaniu.</li>
    <li>Podzapytanie:
      <ul>
        <li><code>SELECT DISTINCT p.kod_obszaru</code> â€“ unikalne kody obszarÃ³w z pomiarami.</li>
        <li><code>INNER JOIN laziki</code> â€“ Å‚Ä…czenie pomiarÃ³w z Å‚azikami.</li>
        <li><code>WHERE YEAR(p.data_pomiaru) = l.rok_wyslania</code> â€“ tylko pomiary z roku wysÅ‚ania.</li>
      </ul>
    </li>
  </ul>
</section>

<!-- Zadanie 7.4 -->
<section>
  <h2>ğŸŒ Zadanie 7.4 â€“ Cel</h2>
  <p>ZnajdÅº Å‚aziki, ktÃ³re <span class="important">wylÄ…dowaÅ‚y na poÅ‚udniowej pÃ³Å‚kuli</span> i wykonywaÅ‚y pomiary na obu pÃ³Å‚kulach.</p>
</section>

<section>
  <h2>Kod SQL</h2>
  <pre><code class="sql">
SELECT l.nazwa_lazika
FROM Laziki AS l
INNER JOIN Pomiary AS p
    ON l.nr_lazika = p.nr_lazika
WHERE l.wsp_ladowania LIKE "*S*"
GROUP BY l.nazwa_lazika
HAVING SUM(IIF(p.wspolrzedne LIKE "*N*", 1, 0)) > 0
   AND SUM(IIF(p.wspolrzedne LIKE "*S*", 1, 0)) > 0;
  </code></pre>
</section>

<section>
  <h2>OgÃ³lne omÃ³wienie</h2>
  <ul>
    <li>Filtrujemy Å‚aziki, ktÃ³re wylÄ…dowaÅ‚y na poÅ‚udniowej pÃ³Å‚kuli.</li>
    <li>Sprawdzamy, czy w pomiarach sÄ… punkty z obu pÃ³Å‚kul.</li>
    <li>UÅ¼ywamy <span class="highlight">HAVING</span> do warunkÃ³w po grupowaniu.</li>
  </ul>
</section>

<section>
  <h2>Analiza linia po linii</h2>
  <ul>
    <li><code>WHERE l.wsp_ladowania LIKE "*S*"</code> â€“ wybiera Å‚aziki z literÄ… "S" w wspÃ³Å‚rzÄ™dnych lÄ…dowania.</li>
    <li><code>GROUP BY l.nazwa_lazika</code> â€“ grupuje dane wedÅ‚ug Å‚azika.</li>
    <li><code>HAVING SUM(IIF(...)) > 0</code> â€“ sprawdza, czy sÄ… pomiary z pÃ³Å‚kuli pÃ³Å‚nocnej i poÅ‚udniowej.</li>
    <li><code>IIF</code> â€“ funkcja warunkowa w Accessie, zwraca 1 jeÅ›li warunek jest speÅ‚niony, 0 jeÅ›li nie.</li>
  </ul>
</section>

<!-- Zadanie 7.5 -->
<section>
  <h2>ğŸ­ Zadanie 7.5 â€“ Cel</h2>
  <p>Podaj nazwy producentÃ³w, ktÃ³rych Å‚aziki badaÅ‚y obszar <span class="important">Arcadia</span> w roku <span class="highlight">2060</span>.</p>
</section>

<section>
  <h2>Kod SQL</h2>
  <pre><code class="sql">
SELECT DISTINCT pr.nazwa
FROM (Producent AS pr
INNER JOIN Laziki AS l
    ON pr.kod_producenta = l.kod_producenta)
INNER JOIN (Pomiary AS pm
INNER JOIN Obszary AS o
    ON pm.kod_obszaru = o.kod_obszaru)
    ON l.nr_lazika = pm.nr_lazika
WHERE o.nazwa_obszaru = "Arcadia"
  AND YEAR(pm.data_pomiaru) = 2060
ORDER BY pr.nazwa;
  </code></pre>
</section>

<section>
  <h2>OgÃ³lne omÃ³wienie</h2>
  <ul>
    <li>ÅÄ…czymy cztery tabele: Producent, Laziki, Pomiary, Obszary.</li>
    <li>Filtrujemy tylko pomiary w Arcadii z roku 2060.</li>
    <li>Usuwamy duplikaty producentÃ³w.</li>
    <li>Sortujemy alfabetycznie.</li>
  </ul>
</section>

<section>
  <h2>Analiza linia po linii</h2>
  <ul>
    <li><code>SELECT DISTINCT pr.nazwa</code> â€“ wybiera unikalne nazwy producentÃ³w.</li>
    <li><code>INNER JOIN</code> â€“ Å‚Ä…czy tabele po kluczach obcych.</li>
    <li><code>WHERE o.nazwa_obszaru = "Arcadia"</code> â€“ filtruje obszar.</li>
    <li><code>YEAR(pm.data_pomiaru) = 2060</code> â€“ filtruje rok pomiaru.</li>
    <li><code>ORDER BY pr.nazwa</code> â€“ sortuje wyniki alfabetycznie.</li>
  </ul>
</section>

<!-- Podsumowanie -->
<section>
  <h2>ğŸ¯ Podsumowanie</h2>
  <ul>
    <li>NauczyliÅ›my siÄ™ Å‚Ä…czyÄ‡ tabele w Access SQL przy pomocy <span class="highlight">JOIN</span>.</li>
    <li>WykorzystaliÅ›my <span class="highlight">GROUP BY</span>, <span class="highlight">HAVING</span>, <span class="highlight">WHERE</span> i <span class="highlight">DISTINCT</span>.</li>
    <li>RozwiÄ…zaliÅ›my krok po kroku zadania 7.1â€“7.5.</li>
    <li>Teraz moÅ¼esz samodzielnie modyfikowaÄ‡ zapytania i analizowaÄ‡ inne dane.</li>
  </ul>
</section>

<section>
  <h1>ğŸ’¡ DziÄ™kujÄ™ za uwagÄ™!</h1>
  <p>SprÃ³buj zmieniÄ‡ warunki w zapytaniach i zobacz, jak zmienia siÄ™ wynik.</p>
</section>

</div>
</div>

<!-- Reveal.js -->
<script src="https://unpkg.com/reveal.js/dist/reveal.js"></script>
<script>
  Reveal.initialize({
    hash: true,
    slideNumber: true,
    transition: 'slide'
  });
</script>

</body>
</html>
